<div class="storage-wrapper">
  <div class="grid-columns-single storage-header">
    {{#if settings.showComponentRating}}
      {{#if settings.showComponentDM}}
        <div class="components-stored-single">
      {{else}}
        <div class="components-stored-single only-rating">
      {{/if}}
    {{else}}
      {{#if settings.showComponentDM}}
        <div class="components-stored-single only-dm">
      {{else}}
        <div class="components-stored-single no-dm-rating">
      {{/if}}
    {{/if}}
      <span class="item-name">{{localize "TWODSIX.Items.Component.componentName"}}</span>
      <span class="item-name centre">{{localize "TWODSIX.Actor.Items.TL"}}</span>
      {{#if settings.showComponentRating}}
      <span class="item-name centre">{{localize "TWODSIX.Items.Component.rating"}}</span>
      {{/if}}
      {{#if settings.showComponentDM}}
      <span class="item-name centre">{{localize "TWODSIX.Items.Component.DM"}}</span>
      {{/if}}
      <span class="item-name centre">{{localize "TWODSIX.Actor.Items.Weight"}}</span>
      <span class="item-name centre">{{localize "TWODSIX.Items.Component.Power"}}</span>
      <span class="item-name centre">{{localize "TWODSIX.Actor.Items.Qty"}}</span>
      <span class="item-name centre">{{localize "TWODSIX.Items.Component.damage"}}</span>
      <span class="item-name centre" data-tooltip='{{localize "TWODSIX.Items.Component.hardened"}}'>{{localize "TWODSIX.Items.Component.Hd"}}</span>
      <span class="item-name centre">{{localize "TWODSIX.Items.Component.hits"}}</span>
      <span class="item-name centre">{{localize "TWODSIX.Items.Component.status"}}</span>
      <span class="item-name centre"><a class="item-control item-create" data-tooltip='{{localize "TWODSIX.Actor.Items.CreateItem"}}' data-type="component" data-subtype = {{@key}}> <i class="fa-solid fa-plus"></i></a></span>
    </div>
  </div>

  <div class="grid-columns-single">
    {{#each component}}
    {{#iff @key "!==" "cargo"}}
    <div class="grid-columns-single-row">
       <ol class="ol-no-indent header-row"><i class= '{{twodsix_getComponentIcon @key}}' data-tooltip='{{localize (concat "TWODSIX.Items.Component." @key)}}'></i> {{twodsix_titleCase (localize (concat "TWODSIX.Items.Component." @key))}}
         <a class="item-control item-create" data-tooltip='{{localize "TWODSIX.Actor.Items.CreateItem"}}' data-type="component" data-subtype = {{@key}}> <i class="fa-solid fa-plus"></i></a>
       </ol>
    </div>
    {{#each this as |item id|}}

    <div class="grid-columns-single-row">
      <ol class="ol-no-indent">
        {{#if ../../settings.showComponentRating}}
          {{#if ../../settings.showComponentDM}}
            <li class="item components-stored-single" data-item-id="{{item.id}}">
          {{else}}
            <li class="item components-stored-single only-rating" data-item-id="{{item.id}}">
          {{/if}}
        {{else}}
          {{#if ../../settings.showComponentDM}}
            <li class="item components-stored-single only-dm" data-item-id="{{item.id}}">
          {{else}}
            <li class="item components-stored-single no-dm-rating" data-item-id="{{item.id}}">
          {{/if}}
        {{/if}}
          {{#iff item.system.actorLink "===" ""}}
            <span class="item-name">{{item.name}}</span>
          {{else}}
            <a class="item-link orange" data-uuid="{{item.system.actorLink}}">{{item.name}}</a>
          {{/iff}}
          <span class="item-name centre">{{#iff item.system.techLevel ">" "0"}}{{item.system.techLevel}}{{else}}&mdash;{{/iff}}</span>
          {{#if ../../settings.showComponentRating}}
          <span class="item-name centre">{{#iff item.system.rating "!==" ""}}{{item.system.rating}}{{else}}&mdash;{{/iff}}</span>
          {{/if}}
          {{#if ../../settings.showComponentDM}}
          <span class="item-name centre">{{#iff item.system.rollModifier "!==" ""}}{{item.system.rollModifier}}{{else}}&mdash;{{/iff}}</span>
          {{/if}}
          <span class="item-name centre">{{getComponentWeight this}}</span>
          <span class="item-name centre">{{getComponentPower this}}</span>
          <span class="item-name centre">{{#if item.system.availableQuantity}}{{item.system.availableQuantity}}/{{/if}}{{item.system.quantity}}</span>

          <span class="item-name centre">
            {{#iff item.system.subtype "===" "armament"}}
              {{#iff item.system.damage "!==" ""}}<span class="roll-damage orange">{{twodsix_limitLength item.system.damage 3}}{{else}}&mdash;{{/iff}}</span>
            {{else}}
             &mdash;
            {{/iff}}
          </span>
          <span class="item-name centre">{{#if item.system.hardened}}<i class="fa-solid fa-gem"></i>{{else}}&mdash;{{/if}}</span>
          <span class="item-name centre">{{item.system.hits}}
          <span class="combined-buttons">
            <button class="left-button adjust-hits" {{#iff currentCount "===" 0}}disabled{{/iff}} data-value="-1" >-</button>
            <button class="right-button adjust-hits" {{#iff currentCount "===" 9}}disabled{{/iff}} data-value="1" >+</button>
          </span>
          </span>
          <span class="item-name centre component-toggle">
            {{#iff item.system.status "===" 'operational'}} <i class="fa-solid fa-circle-check" style="color: green;" data-tooltip='{{localize "TWODSIX.Items.Component.operational"}}'></i>
            {{else}}
              {{#iff item.system.status "===" 'damaged'}} <i class="fa-solid fa-circle-exclamation" style="color: yellow;" data-tooltip='{{localize "TWODSIX.Items.Component.damaged"}}'></i>
            {{else}}
              {{#iff item.system.status "===" 'destroyed'}} <i class="fa-solid fa-circle-x" style="color: red;" data-tooltip='{{localize "TWODSIX.Items.Component.destroyed"}}'></i>
            {{else}}
              {{#iff item.system.status "===" 'off'}} <i class="fa-solid fa-power-off" style="color: grey;" data-tooltip='{{localize "TWODSIX.Items.Component.off"}}'></i>
            {{/iff}} {{/iff}} {{/iff}} {{/iff}}
          </span>
          <span class="item-controls centre">
            <a class="item-control item-edit" data-tooltip='{{localize "TWODSIX.Actor.Items.EditItem"}}'><i
              class="fa-solid fa-pen-to-square"></i></a>
            <a class="item-control item-delete" data-tooltip='{{localize "TWODSIX.Actor.Items.DeleteItem"}}'><i
              class="fa-solid fa-trash"></i></a>
          </span>
        </li>
      </ol>
    </div>
    {{/each}}
    {{/iff}}
    {{/each}}
  </div>
</div>
